<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>WinVision</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <form id="prediction-form" onsubmit="sendtoapi(event)">
      <div style="margin-bottom: 100px;">
        <label for="f1-racers">Drivers:</label>
        <select id="f1-racers" name="f1-racers">
          <option value="george-russell">George Russell</option>
          <option value="lando-norris">Lando Norris</option>
          <option value="oscar-piastri">Oscar Piastri</option>
          <option value="daniel-ricciardo">Daniel Ricciardo</option>
          <option value="fernando-alonso">Fernando Alonso</option>
          <option value="lewis-hamilton">Lewis Hamilton</option>
          <option value="yuki-tsunoda">Yuki Tsunoda</option>
          <option value="lance-stroll">Lance Stroll</option>
          <option value="alexander-albon">Alexander Albon</option>
          <option value="charles-leclerc">Charles Leclerc</option>
          <option value="carlos-sainz">Carlos Sainz</option>
          <option value="logan-sargeant">Logan Sargeant</option>
          <option value="kevin-magnussen">Kevin Magnussen</option>
          <option value="pierre-gasly">Pierre Gasly</option>
          <option value="sergio-perez">Sergio Pérez</option>
          <option value="valtteri-bottas">Valtteri Bottas</option>
          <option value="esteban-ocon">Esteban Ocon</option>
          <option value="max-verstappen">Max Verstappen</option>
          <option value="nico-hulkenberg">Nico Hülkenberg</option>
          <option value="guanyu-zhou">Guanyu Zhou</option>
        </select>
        <button type="button" onclick="addDriver()">Add Driver</button>
            <button type="button" onclick="displayDrivers()">Display Drivers</button>
            <div style="display: block;">
                <label for="circuit">Circuit:</label>
                <input type="text" id="circuit" name="circuit" />
            </div>
            <input type="hidden" id="selected-drivers-input" name="selected-drivers" />
            <button type="submit" class="btn-large waves-effect waves-light orange">
                Predict Probability
            </button>
      </div>
    </form>

    <div id="selected-drivers" style="margin-bottom: 1000px;">
      <h3>Selected Drivers:</h3>
      <ul id="drivers-list"></ul>
      <p id="selected-circuit"></p>
    </div>
    <div id="prediction-results">
      <h3>Prediction Results:</h3>
      <ul id="results-list"></ul>
  </div>

  <script>
      const selectedDrivers = [];
      const maxDrivers = 20;

      function addDriver() {
          const selectElement = document.getElementById('f1-racers');
          const selectedDriver = selectElement.options[selectElement.selectedIndex].text;

          if (selectedDrivers.length < maxDrivers) {
              selectedDrivers.push(selectedDriver);
              alert(`${selectedDriver} added to the list.`);
          } else {
              alert('Maximum number of drivers selected.');
          }
      }

      function displayDrivers() {
            const driversListElement = document.getElementById('drivers-list');
            const circuitElement = document.getElementById('selected-circuit');
            const circuitInput = document.getElementById('circuit').value;

            driversListElement.innerHTML = '';

            selectedDrivers.forEach((driver, index) => {
                const listItem = document.createElement('li');
                listItem.textContent = `POS ${index + 1}: ${driver}`;
                driversListElement.appendChild(listItem);
            });

            circuitElement.textContent = `Selected Circuit: ${circuitInput}`;
            console.log(selectedDrivers);
        }

        // selectedDrivers stores the grid positions
        //circuitInput stores circuit
        function sendtoapi(event) {
          event.preventDefault();
          const circuitInput = document.getElementById('circuit').value;
          document.getElementById('selected-drivers-input').value = JSON.stringify(selectedDrivers);
          const selectedDriversInput = selectedDrivers;

          fetch('http://127.0.0.1:5000/predict', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify({ selectedDrivers: selectedDriversInput, circuit: circuitInput }),
          })
          .then((response) => response.json())
          .then((data) => {
              displayResults(data);
          })
          .catch((error) => {
              console.error('Error:', error);
          });
      }

      function displayResults(results) {
          const resultsListElement = document.getElementById('results-list');
          resultsListElement.innerHTML = '';

          const card1 = document.getElementById('card1');
    if (card1 && results[2]) {
        card1.querySelector('p').textContent = results[2];
    }

    // Update the content of the second card
    const card2 = document.getElementById('card2');
    if (card2 && results[1]) {
        card2.querySelector('p').textContent = results[1];
    }

    // Update the content of the third card
    const card3 = document.getElementById('card3');
    if (card3 && results[0]) {
        card3.querySelector('p').textContent = results[0];
    }
      }
      
      
  
  </script>
    

<div class="cards-container">
  <div class="card" id="card2">
      <div class="align">
          <span class="red"><h3></h3></span>
          <span class="yellow"></span>
          <span class="green"><h4>2ND</h4></span>
      </div>
      <h1>HOVER ME</h1>
      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
  </div>

  <div class="card" id="card1">
      <div class="align">
          <span class="red"><h3></h3></span>
          <span class="yellow"></span>
          <span class="green"><h4>1ST</h4></span>
      </div>
      <h1>HOVER ME</h1>
      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
  </div>

  <div class="card" id="card3">
      <div class="align">
          <span class="red"><h3></h3></span>
          <span class="yellow"></span>
          <span class="green"><h4>3RD</h4></span>
      </div>
      <h1>HOVER ME</h1>
      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
  </div>
</div>
    <h2>
        WinVision
    </h2>
    <section class = "hidden">
      <h1>testing model</h1>
    </section>
    <section class = "hidden">
        Welcome to WinVision
    </section>
    <section class = "hidden">
        <div id="container3D"></div>
    </section>

    <script type="module" src="script.js"></script>
  </body>
</html>